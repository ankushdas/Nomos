type lottery = /\ <{1.}| p+{won{0.1} : |{*}> \/ lottery,
                           lost{0.9} : \/ lottery}

proc contract lottery_proc : . |{*}- (#sl : lottery) =
{
  $ll <- accept #sl ;
  get $ll {*} ;
  flip {0.1} (
    HH => $ll..won ;
          pay $ll {*} ;
          #sl <- detach $ll ;
          #sl <- lottery_proc <-
  | TT => $ll..lost ;
          #sl <- detach $ll ;
          #sl <- lottery_proc <-
  )
}
type A = p+{H{0.5} : 1, T{0.5} : 1}
type B = p+{H{0.25} : 1, T{0.75} : 1}

proc asset and : ($x : A), ($y : A) |- ($z : B) =
{
  pcase $x (
    H => pcase $y (
      H => $z..H ;
           wait $x ;
           wait $y ;
           close $z
    | T => $z..T ;
           wait $x ;
           wait $y ;
           close $z
    )
  | T => pcase $y (
      H => $z..T ;
           wait $x ;
           wait $y ;
           close $z
    | T => $z..T ;
           wait $x ;
           wait $y ;
           close $z
    )
  )
}
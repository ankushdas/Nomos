proc transaction main1 : . |{*}- ($d : 1) =
{
  let n = 1000 ;
  $c <- create_wallet <- n ;
  $d <- $c
}

proc transaction create_wallet : (n : int) |{*}- ($d : 1) =
{
  $m <- money_proc <- n ;
  print ("created a money process at %c\n\n", $m);
  #sw <- wallet_proc <- $m ;
  print ("created a wallet with %d coins\non channel %c\n", n, #sw);
  close $d
}

exec main1